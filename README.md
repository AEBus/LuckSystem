# LUCA System Tools

## LUCA Script



## 脚本结构

| 类型  |  长度 | 名称 |  说明 | 
|------|-------|-----|-----|
| uint16 |  2  | len | 代码长度|
| uint8 |  1  | opcode | 指令索引|
| uint8 |  1  | flag | 一个标志，值0~3|
| []uint16 |  2 * n  | data0 | 未知参数，其中n=flag(flag<3),n=2(flag==3)|
| params |  len -4 -2*n  | params | 参数|
| uint8 |  k  | align | 补齐位，其中k=len%2|


uint16 2 byte 整条语句的长度  
uint8 1 byte

## 更新日志

### 7.13
- 增加engine结构，即引擎层，与虚拟机做区分
  - 虚拟机：执行脚本内容，保存、计算变量等逻辑相关操作
  - 引擎：执行模拟器的显示、交互等

### 7.12
- 支持表达式计算
  - 表达式的读取以及中缀表达式转后缀表达式
  - 后缀表达式的计算
- 引擎中使用内置数据类型，不在使用包装数据类型


### 7.11
- 重构代码结构，使用vm来处理脚本执行相关
- 增加context，在执行中传递变量表等数据
- 增加变量表，储存运行时变量
- 优化参数的读取
- 统一接口代码，虚拟机与引擎前端交互接口

### 6.30
- 支持多游戏
- 设计参数、函数等结构

### 6.28
- 框架设计与编写
- 第三方包的选择与测试
- 支持LB_EN基本解析

### 计划
- 支持更多LucaSystem引擎的游戏脚本解析
- 完善引擎函数
- 引擎层交互的初步实现